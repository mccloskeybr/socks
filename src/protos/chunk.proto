syntax = "proto3";

import "schema.proto";

message Chunk {
  oneof chunk_type {
    Metadata metadata = 2;
    Directory directory = 3;
    RowDataNode row_data = 4;
  }
}

message Metadata {
  uint64 next_chunk_id = 1;
  uint64 next_chunk_offset = 2;
  IndexSchema schema = 3;
  uint64 root_chunk_id = 4;
  uint64 num_directories = 5;
}

message Directory {
  message Entry {
    uint64 id = 1;
    uint64 offset = 2;
  }
  repeated Entry entries = 1;
}

message RowDataNode {
  uint64 id = 1;
  message Value {
    oneof node_type {
      InternalRow row_node = 1;
      uint64 child_id = 2;
    }
  }
  repeated Value values = 2;
}

message InternalRow {
  string key = 1;
  repeated InternalColumn col_values = 2;
}

message InternalColumn {
  oneof value {
    bool is_empty = 1;
    int32 int_value = 2;
  }
}
